curl -X 'GET' \
  'http://0.0.0.0:8080/api/players/top?position=QB&n=10&ascending=false&season_type=REG&redzone_only=false&aggregation_type=season&include_player_details=true' \
  -H 'accept: application/json'

{
  "position": "QB",
  "leaderboard": [
    {
      "season": 2004,
      "player_id": "00-0010346",
      "player_name": "Peyton Manning",
      "team": "IND",
      "position": "P",
      "games_played": 16,
      "attempts": 497,
      "completions": 336,
      "completion_pct": 67.6056338028169,
      "passing_yards": 4456,
      "passing_tds": 49,
      "passing_interceptions": 10,
      "qb_epa": 221.4964524093534,
      "passing_cpoe": null,
      "epa_per_dropback": 0.43601663860108936,
      "passing_air_yards": 0,
      "passing_yards_after_catch": 0,
      "pacr": null,
      "passing_first_downs": 232,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 13,
      "passing_fumbles": 8,
      "passing_fumbles_lost": 3,
      "qb_dropback": 508,
      "fantasy_points": 348.24,
      "season_type": "REG",
      "player_first_name": "Peyton",
      "player_last_name": "Manning",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Tennessee",
      "player_height": 77,
      "player_weight": 230,
      "player_birth_date": "1976-03-24",
      "player_draft_club": "IND",
      "player_draft_number": 1,
      "player_team_abbr": "DEN",
      "player_headshot": "https://static.www.nfl.com/image/private/f_auto,q_auto/league/xpcd6auodk3w0vda6jal"
    },
    {
      "season": 2007,
      "player_id": "00-0019596",
      "player_name": "Tom Brady",
      "team": "NE",
      "position": "P",
      "games_played": 16,
      "attempts": 578,
      "completions": 398,
      "completion_pct": 68.85813148788927,
      "passing_yards": 4678,
      "passing_tds": 50,
      "passing_interceptions": 8,
      "qb_epa": 250.0281579677097,
      "passing_cpoe": 7.8124111505238325,
      "epa_per_dropback": 0.4174092787440896,
      "passing_air_yards": 4746,
      "passing_yards_after_catch": 2045,
      "pacr": 0.9856721449641803,
      "passing_first_downs": 240,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 21,
      "passing_fumbles": 10,
      "passing_fumbles_lost": 4,
      "qb_dropback": 599,
      "fantasy_points": 363.12,
      "season_type": "REG",
      "player_first_name": "Tom",
      "player_last_name": "Brady",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Michigan",
      "player_height": 76,
      "player_weight": 225,
      "player_birth_date": "1977-08-03",
      "player_draft_club": "NE",
      "player_draft_number": 199,
      "player_team_abbr": "TB",
      "player_headshot": "https://static.www.nfl.com/image/private/f_auto,q_auto/league/q7dpdlxyu5rs05rgh1le"
    },
    {
      "season": 2011,
      "player_id": "00-0023459",
      "player_name": "Aaron Rodgers",
      "team": "GB",
      "position": "P",
      "games_played": 15,
      "attempts": 501,
      "completions": 342,
      "completion_pct": 68.26347305389221,
      "passing_yards": 4417,
      "passing_tds": 45,
      "passing_interceptions": 6,
      "qb_epa": 223.36792698807292,
      "passing_cpoe": 8.81097502136433,
      "epa_per_dropback": 0.4167312070673002,
      "passing_air_yards": 4549,
      "passing_yards_after_catch": 2015,
      "pacr": 0.9709826335458343,
      "passing_first_downs": 208,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 36,
      "passing_fumbles": 5,
      "passing_fumbles_lost": 0,
      "qb_dropback": 536,
      "fantasy_points": 344.68,
      "season_type": "REG",
      "player_first_name": "Aaron",
      "player_last_name": "Rodgers",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "California",
      "player_height": 74,
      "player_weight": 225,
      "player_birth_date": "1983-12-02",
      "player_draft_club": "GB",
      "player_draft_number": 24,
      "player_team_abbr": "NYJ",
      "player_headshot": "https://static.www.nfl.com/image/upload/f_auto,q_auto/league/jdcb4nomlc4rd6k5l6to"
    },
    {
      "season": 2011,
      "player_id": "00-0023459",
      "player_name": "Aaron Rodgers",
      "team": "GB",
      "position": "P",
      "games_played": 15,
      "attempts": 501,
      "completions": 342,
      "completion_pct": 68.26347305389221,
      "passing_yards": 4417,
      "passing_tds": 45,
      "passing_interceptions": 6,
      "qb_epa": 223.36792698807292,
      "passing_cpoe": 8.81097502136433,
      "epa_per_dropback": 0.4167312070673002,
      "passing_air_yards": 4549,
      "passing_yards_after_catch": 2015,
      "pacr": 0.9709826335458343,
      "passing_first_downs": 208,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 36,
      "passing_fumbles": 5,
      "passing_fumbles_lost": 0,
      "qb_dropback": 536,
      "fantasy_points": 344.68,
      "season_type": "REG",
      "player_first_name": "Aaron",
      "player_last_name": "Rodgers",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "California",
      "player_height": 74,
      "player_weight": 225,
      "player_birth_date": "1983-12-02",
      "player_draft_club": "GB",
      "player_draft_number": 24,
      "player_team_abbr": "NYJ",
      "player_headshot": "https://static.www.nfl.com/image/upload/f_auto,q_auto/league/jdcb4nomlc4rd6k5l6to"
    },
    {
      "season": 2013,
      "player_id": "00-0010346",
      "player_name": "Peyton Manning",
      "team": "DEN",
      "position": "P",
      "games_played": 16,
      "attempts": 659,
      "completions": 450,
      "completion_pct": 68.28528072837632,
      "passing_yards": 5357,
      "passing_tds": 55,
      "passing_interceptions": 10,
      "qb_epa": 262.2390975704832,
      "passing_cpoe": 6.38538162688232,
      "epa_per_dropback": 0.3873546492917034,
      "passing_air_yards": 5169,
      "passing_yards_after_catch": 2584,
      "pacr": 1.0363706713097312,
      "passing_first_downs": 289,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 18,
      "passing_fumbles": 9,
      "passing_fumbles_lost": 5,
      "qb_dropback": 677,
      "fantasy_points": 404.28,
      "season_type": "REG",
      "player_first_name": "Peyton",
      "player_last_name": "Manning",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Tennessee",
      "player_height": 77,
      "player_weight": 230,
      "player_birth_date": "1976-03-24",
      "player_draft_club": "IND",
      "player_draft_number": 1,
      "player_team_abbr": "DEN",
      "player_headshot": "https://static.www.nfl.com/image/private/f_auto,q_auto/league/xpcd6auodk3w0vda6jal"
    },
    {
      "season": 2005,
      "player_id": "00-0010346",
      "player_name": "Peyton Manning",
      "team": "IND",
      "position": "P",
      "games_played": 16,
      "attempts": 453,
      "completions": 305,
      "completion_pct": 67.3289183222958,
      "passing_yards": 3666,
      "passing_tds": 28,
      "passing_interceptions": 10,
      "qb_epa": 179.48990499082808,
      "passing_cpoe": null,
      "epa_per_dropback": 0.3810826008297836,
      "passing_air_yards": 0,
      "passing_yards_after_catch": 0,
      "pacr": null,
      "passing_first_downs": 197,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 17,
      "passing_fumbles": 5,
      "passing_fumbles_lost": 2,
      "qb_dropback": 471,
      "fantasy_points": 234.64,
      "season_type": "REG",
      "player_first_name": "Peyton",
      "player_last_name": "Manning",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Tennessee",
      "player_height": 77,
      "player_weight": 230,
      "player_birth_date": "1976-03-24",
      "player_draft_club": "IND",
      "player_draft_number": 1,
      "player_team_abbr": "DEN",
      "player_headshot": "https://static.www.nfl.com/image/private/f_auto,q_auto/league/xpcd6auodk3w0vda6jal"
    },
    {
      "season": 2018,
      "player_id": "00-0033873",
      "player_name": "Patrick Mahomes",
      "team": "KC",
      "position": "P",
      "games_played": 16,
      "attempts": 580,
      "completions": 383,
      "completion_pct": 66.03448275862068,
      "passing_yards": 4926,
      "passing_tds": 50,
      "passing_interceptions": 12,
      "qb_epa": 221.76140385950282,
      "passing_cpoe": 4.472190452450737,
      "epa_per_dropback": 0.36594291065924556,
      "passing_air_yards": 5255,
      "passing_yards_after_catch": 2613,
      "pacr": 0.9373929590865842,
      "passing_first_downs": 237,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 26,
      "passing_fumbles": 10,
      "passing_fumbles_lost": 5,
      "qb_dropback": 606,
      "fantasy_points": 363.03999999999996,
      "season_type": "REG",
      "player_first_name": "Patrick",
      "player_last_name": "Mahomes",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Texas Tech",
      "player_height": 75,
      "player_weight": 230,
      "player_birth_date": "1995-09-17",
      "player_draft_club": "KC",
      "player_draft_number": 10,
      "player_team_abbr": "KC",
      "player_headshot": "https://static.www.nfl.com/image/upload/f_auto,q_auto/league/qrdbvu4iqy7wkqg8jq8d"
    },
    {
      "season": 2013,
      "player_id": "00-0021206",
      "player_name": "Josh McCown",
      "team": "CHI",
      "position": "P",
      "games_played": 8,
      "attempts": 224,
      "completions": 149,
      "completion_pct": 66.51785714285714,
      "passing_yards": 1794,
      "passing_tds": 13,
      "passing_interceptions": 1,
      "qb_epa": 83.06691675626953,
      "passing_cpoe": 4.87264641306617,
      "epa_per_dropback": 0.3519784608316506,
      "passing_air_yards": 1769,
      "passing_yards_after_catch": 835,
      "pacr": 1.0141322781232334,
      "passing_first_downs": 90,
      "passing_2pt_conversions": 1,
      "sacks_suffered": 11,
      "passing_fumbles": 4,
      "passing_fumbles_lost": 2,
      "qb_dropback": 236,
      "fantasy_points": 119.76,
      "season_type": "REG",
      "player_first_name": "Joshua",
      "player_last_name": "McCown",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Sam Houston State",
      "player_height": 76,
      "player_weight": 218,
      "player_birth_date": "1979-07-04",
      "player_draft_club": "ARI",
      "player_draft_number": 81,
      "player_team_abbr": "HOU",
      "player_headshot": "https://static.www.nfl.com/image/private/f_auto,q_auto/league/qcauc37wqjdaxdbq1evu"
    },
    {
      "season": 2013,
      "player_id": "00-0021206",
      "player_name": "Josh McCown",
      "team": "CHI",
      "position": "P",
      "games_played": 8,
      "attempts": 224,
      "completions": 149,
      "completion_pct": 66.51785714285714,
      "passing_yards": 1794,
      "passing_tds": 13,
      "passing_interceptions": 1,
      "qb_epa": 83.06691675626953,
      "passing_cpoe": 4.87264641306617,
      "epa_per_dropback": 0.3519784608316506,
      "passing_air_yards": 1769,
      "passing_yards_after_catch": 835,
      "pacr": 1.0141322781232334,
      "passing_first_downs": 90,
      "passing_2pt_conversions": 1,
      "sacks_suffered": 11,
      "passing_fumbles": 4,
      "passing_fumbles_lost": 2,
      "qb_dropback": 236,
      "fantasy_points": 119.76,
      "season_type": "REG",
      "player_first_name": "Joshua",
      "player_last_name": "McCown",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Sam Houston State",
      "player_height": 76,
      "player_weight": 218,
      "player_birth_date": "1979-07-04",
      "player_draft_club": "ARI",
      "player_draft_number": 81,
      "player_team_abbr": "HOU",
      "player_headshot": "https://static.www.nfl.com/image/private/f_auto,q_auto/league/qcauc37wqjdaxdbq1evu"
    },
    {
      "season": 2024,
      "player_id": "00-0034796",
      "player_name": "Lamar Jackson",
      "team": "BAL",
      "position": "P",
      "games_played": 17,
      "attempts": 474,
      "completions": 316,
      "completion_pct": 66.66666666666667,
      "passing_yards": 4023,
      "passing_tds": 41,
      "passing_interceptions": 4,
      "qb_epa": 172.27861165601786,
      "passing_cpoe": 4.551942420032056,
      "epa_per_dropback": 0.3487421288583357,
      "passing_air_yards": 4109,
      "passing_yards_after_catch": 2084,
      "pacr": 0.979070333414456,
      "passing_first_downs": 198,
      "passing_2pt_conversions": 0,
      "sacks_suffered": 23,
      "passing_fumbles": 5,
      "passing_fumbles_lost": 2,
      "qb_dropback": 494,
      "fantasy_points": 312.92,
      "season_type": "REG",
      "player_first_name": "Lamar",
      "player_last_name": "Jackson",
      "player_position": "QB",
      "player_position_group": "QB",
      "player_college_name": "Louisville",
      "player_height": 74,
      "player_weight": 212,
      "player_birth_date": "1997-01-07",
      "player_draft_club": "BAL",
      "player_draft_number": 32,
      "player_team_abbr": "BAL",
      "player_headshot": "https://static.www.nfl.com/image/upload/f_auto,q_auto/league/cruqs6qpbykh7a2whd7p"
    }
  ]
}


INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8080 (Press CTRL+C to quit)
INFO:     127.0.0.1:49491 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:49491 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:49491 - "GET /openapi.json HTTP/1.1" 200 OK
TOP PLAYERS ENDPOINT: Position=QB, Aggregation=season, Week=None, Seasons=None
DEBUG: PBP parquet file exists with 1184719 rows
DEBUG: Seasons available: [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024]
DEBUG: Weeks available: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
DEBUG: calculate_qb_stats input:
  - Input pbp rows: 1184719
  - Aggregation: season, Seasons: None, Week: None
/Users/shaanchanchani/dev/nfl-data-api/src/nfl_data/endpoints/player_stats.py:600: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  result['position'] = result['player_id'].map(
DEBUG: After applying thresholds:
  - 1419 rows remaining
  - Columns: ['season', 'player_id', 'player_name', 'team', 'position', 'games_played', 'attempts', 'completions', 'completion_pct', 'passing_yards', 'passing_tds', 'passing_interceptions', 'qb_epa', 'passing_cpoe', 'epa_per_dropback', 'passing_air_yards', 'passing_yards_after_catch', 'pacr', 'passing_first_downs', 'passing_2pt_conversions', 'sacks_suffered', 'passing_fumbles', 'passing_fumbles_lost', 'qb_dropback', 'fantasy_points', 'season_type']
  - Sample sort values for epa_per_dropback: [-0.10269202930211097, -0.05229911122973512, -0.15558200744618605]
DEBUG: After sorting, got 10 top players for season aggregation
INFO:     127.0.0.1:49492 - "GET /api/players/top?position=QB&n=10&ascending=false&season_type=REG&redzone_only=false&aggregation_type=season&include_player_details=true HTTP/1.1" 200 OK